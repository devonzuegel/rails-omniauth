(function(){var t,e,r,i,n,s,a,l,u,f,c,h,o,p,d=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};p=React.DOM,r=p.div,n=p.h1,s=p.h2,a=p.h3,l=p.h4,u=p.h5,f=p.h6,o=p.p,t=p.a,i=p.form,e=p.button,h=p.input,c=p.icon,this.Entries=React.createClass({displayName:"Entries",getInitialState:function(){return{current_filter:"default",entries:this.props.entries,labeled_filters:this.props.filters,api_key:this.props.api_key}},getDefaultProps:function(){return{entries:[],labeled_filters:[],api_key:""}},render:function(){var t,e;return r({className:"entries"},r({className:"row extra-padding"},function(){var t,r,i,n;for(i=this.state.labeled_filters,n=[],t=0,r=i.length;r>t;t++)e=i[t],n.push(React.createElement(Filter,{handleClick:this.filter,filter_name:e.filter,label:e.label,ref:this.filter_ref(e),api_key:this.state.api_key}));return n}.call(this)),r({className:"tiles"},function(){var e,r,i,n;for(i=this.state.entries,n=[],e=0,r=i.length;r>e;e++)t=i[e],n.push(React.createElement(Entry,{key:t.id,entry:t,handleDeletedEntries:this.deleteEntries}));return n}.call(this)))},componentDidMount:function(){var t,e;return t=0,e=_.debounce(this.search_filter,t),PubSub.subscribe("searchbar:onChange",function(){return function(){return e()}}(this)),this.setState({tiles:new Tiles})},componentDidUpdate:function(){var t,e,r,i,n,s;for(this.state.tiles.update(),n=this.state.labeled_filters,s=[],r=0,i=n.length;i>r;r++)t=n[r],e=this.refs[this.filter_ref(t)],s.push(e.update_count());return s},deleteEntries:function(t){var e;return t||(t=[]),e=this.state.entries.slice().filter(function(e){var r;return r=e.id,d.call(t,r)<0}),this.setState({entries:e})},filter:function(t,e){return this.setState({entries:t,current_filter:e})},filter_ref:function(t){return"filter-"+t.filter},search_filter:function(){var t;return t={api_key:""+this.state.api_key,query:""+$("#searchbar-input").val(),filter:this.props.current_filter},$.getJSON("api/v1/entries",t,function(t){return function(e){return t.filter(e)}}(this))}}),this.Filter=React.createClass({getInitialState:function(){return this.update_count(),{api_key:this.props.api_key,count:"  "}},render:function(){var e;return e=this.props.label+" ("+this.state.count+")",r({className:"extra-padding pull-right"},t({id:this.props.filter_name+"-filter",onClick:this.filter},e))},filter:function(){return $.getJSON("api/v1/entries",this.data(),function(t){return function(e){return t.props.handleClick(e,t.props.filter_name)}}(this))},update_count:function(){return $.getJSON("api/v1/entries",this.data(),function(t){return function(e){return t.setState({count:e.length})}}(this))},data:function(){var t;return t={filter:""+this.props.filter_name,api_key:""+this.props.api_key,query:""+$("#searchbar-input").val()}}})}).call(this);